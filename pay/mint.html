<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mint 100 402DOG</title>
    <style>
      html, body { height:100%; }
      body { margin:0; display:grid; place-items:center; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0b1220; color:#e5e7eb; }
      .card { max-width:560px; width:92%; background:#0f172a; border:1px solid #1f2a44; border-radius:16px; padding:28px; text-align:center; }
      button { padding:12px 18px; border-radius:10px; border:1px solid #4d6fff; background:#1d4ed8; color:#fff; cursor:pointer; }
    </style>
  </head>
  <body>
    <main class="card">
      <h2>Payment Required</h2>
      <p>Pay 0.01 USDC on Base to mint 100 402DOG</p>
      <button id="connect">Connect wallet & Pay</button>
      <div id="hint" style="margin-top:12px; font-size:12px; color:#8aa0c5;"></div>
    </main>
    <script>
      function qs(name){const url=new URL(location.href);return url.searchParams.get(name)||''}
      async function connect() {
        if (window.ethereum?.request) {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          return accounts?.[0] || '';
        }
        return '';
      }
      async function start() {
        let addr = qs('address');
        if (!addr) addr = await connect();
        if (!addr) { document.getElementById('hint').textContent = 'Please install/enable a wallet and try again.'; return; }
        // Top-level navigation to ensure wallets intercept 402
        location.href = `/mint?address=${addr}`;
      }
      document.getElementById('connect').onclick = start;
    </script>
  </body>
</html>
